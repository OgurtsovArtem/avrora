class Observer{constructor({element:e,activationRangeTop:t,activationRangeBottom:s,playOnce:r,updateFrequency:o,activeClass:i,top:n,bottom:a,imageLoad:l}){this.element=e,this.top=t?n||0:null,this.bottom=s?a||0:null,this.activationRangeTop=t||!1,this.activationRangeBottom=s||!1,this.playOnce=r||!1,this.updateFrequency=o||20,this.activeClass=i||"_scroll",this.imageLoad=l,this.entries=null,this.observer=null,this.observe()}_thresholdArray(){return Array(this.updateFrequency+1).fill(0).map((e,t)=>t/this.updateFrequency||0)}_handleIntersect(e){[this.entries]=e,this.scrollHandler(),this.playOnce&&this.unobserve()}observe(){this.observer=new IntersectionObserver(this._handleIntersect.bind(this),{threshold:this._thresholdArray()}),this.observer.observe(this.element)}unobserve(){const e=()=>{this.observer.unobserve(this.element),this.element.removeEventListener("transitionend",e)};this.element.addEventListener("transitionend",e)}addClass(){this.element.classList.remove(this.activeClass)}removeClass(){this.element.classList.add(this.activeClass)}scrollHandler(){this.activationRangeTop||this.activationRangeBottom?this.determiningDirection():this.inObject()}determiningDirection(){this.activationRangeTop?this.atDistanceOnTop():this.activationRangeBottom&&this.atDistanceOnBottom()}atDistanceOnTop(){return this.entries.boundingClientRect.top>=this.top?this.addClass():this.removeClass()}atDistanceOnBottom(){return this.entries.boundingClientRect.bottom<=this.bottom?this.addClass():this.removeClass()}setImageSrc(){var e=this.element.dataset.src;this.element.setAttribute("src",e),this.element.onload=()=>{this.observer.unobserve(this.element),this.element.removeAttribute("data-src"),this.element.dataset.lazy="done"},this.element.onerror=()=>{this.element.dataset.lazy="error-loading"}}inObject(){this.entries.isIntersecting?(this.addClass(),this.imageLoad&&this.setImageSrc()):this.removeClass()}}const lazyImages=[...document.querySelectorAll("img[data-lazy]")];lazyImages&&lazyImages.forEach(e=>{new Observer({element:e,imageLoad:!0})});class Popups{constructor({popup:e,openButtons:t,closeButtons:s,activeClass:r}){this.popup=e,this.openButtons=t,this.closeButtons=s,this.activeClass=r||"_active",e&&this.init()}init(){this.closeButtons.forEach(e=>{e.addEventListener("click",this.close.bind(this))}),this.openButtons.forEach(e=>{e.addEventListener("click",this.open.bind(this))})}open(){this.popup.classList.add(this.activeClass),document.body.style.overflow="hidden"}close(){this.popup.classList.remove(this.activeClass),document.body.style.overflow="initial"}}class Form{constructor(e,{errorClass:t,popupNext:s,popupCurrent:r}){this.form=e,this.errorClass=t,this.popupNext=s,this.popupCurrent=r,this.submitButton=null,this.inputs=[],this.words={validationLenght:"Недостаточно символов",validationNull:"Это обязательное поле",validationEmail:"Неправильный формат Email",submitError:"Ошибка отправки формы"},this.form&&(this.searchFormElements(),this.inputObserve(),this.checkFormValidity(),this.submit())}searchFormElements(){[...this.form.elements].forEach(e=>{"INPUT"!==e.nodeName&&"TEXTAREA"!==e.nodeName||this.inputs.push(e),"BUTTON"===e.nodeName&&"submit"===e.type&&(this.submitButton=e)})}inputObserve(){this.inputs.forEach(e=>{this.setListener(e)})}cleanInputs(){this.inputs.forEach(e=>{e.value=""})}checkFormValidity(){this.submitButton.addEventListener("click",()=>{this.inputs.forEach(e=>{this.checkInputValidity(e)})})}formTarget(e){e=e.target;"tel"===e.type&&this.phoneMask(e),this.checkInputValidity(e),0<e.value.length?this.addFilledCalss(e):this.removeFilledClass(e)}errorTemplate(e){return` <span class="${this.errorClass}">${e}</span>`}inputError(e,t){e.classList.add("_error"),e.insertAdjacentHTML("afterend",this.errorTemplate(t).trim())}removeInputError(e){e.classList.remove("_error");const t=e.nextSibling;1==t.nodeType&&t.classList.contains(this.errorClass)&&t.remove()}checkInputValidity(e){var{validationLenght:t,validationNull:s,validationEmail:r}=this.words;switch(this.removeInputError(e),!0){case e.validity.tooShort:this.inputError(e,t);break;case e.validity.valueMissing:this.inputError(e,s);break;case e.validity.typeMismatch:this.inputError(e,r);break;default:this.removeInputError(e)}}preloaderTemplate(){return`
      <div class="preloader">
        <div class="preloader__container"><span class="preloader__item preloader__item_1"></span><span class="preloader__item preloader__item_2"></span><span class="preloader__item preloader__item_3"></span><span class="preloader__item preloader__item_4"></span><span class="preloader__item preloader__item_5"></span><span class="preloader__item preloader__item_6"></span><span class="preloader__item preloader__item_7"></span><span class="preloader__item preloader__item_8"></span><span class="preloader__item preloader__item_9"></span><span class="preloader__item preloader__item_10"></span>
        </div>
      </div>
    `}runPreloader(){this.submitButton.insertAdjacentHTML("beforeend",this.preloaderTemplate().trim())}stopPreloader(){this.submitButton.lastChild.remove()}submit(){let t=!1;this.form.addEventListener("submit",e=>{e.preventDefault(),t||(e=new FormData(this.form),t=!0,this.runPreloader(),this.submitButton.dataset.errorName="",this.sendForm(e).then(()=>{this.form.dataset.state="success",this.popupCurrent&&this.popupCurrent.close(),this.popupNext&&this.popupNext.open()}).catch(e=>{this.form.dataset.state="error",this.submitButton.dataset.errorName=this.words.submitError,console.error(e)}).finally(()=>{this.stopPreloader(),this.cleanInputs(),t=!1}))})}sendForm(e){e=JSON.stringify({name:this.form.name,data:JSON.stringify(e)});return fetch("/",{method:"POST",credentials:"include",mode:"no-cors",headers:{"Content-Type":"form/multipart"},body:e}).then(e=>{if(e.ok)return e;throw e})}phoneMask(e){let t=e.value.replace(/\D/g,"");t=t&&"+7"+((t=(t="7"!==t[0]&&"8"!==t[0]?t:t.slice(1)).match(/(\d{0,3})(\d{0,3})(\d{0,2})(\d{0,2})/))[2]?"("+t[1]+")"+t[2]:t[1]||"")+(t[3]?"-"+t[3]:"")+(t[4]?"-"+t[4]:""),e.value=t}addFilledCalss(e){e.classList.add("_filled")}removeFilledClass(e){e.classList.remove("_filled")}setListener(e){e.addEventListener("input",this.formTarget.bind(this))}}const calcPopup=new Popups({popup:document.querySelector(".calc-popup"),closeButtons:document.querySelectorAll(".calc-popup__close"),openButtons:document.querySelectorAll("[data-popup-open='calc']")}),callPopup=new Popups({popup:document.querySelector(".call-popup"),closeButtons:document.querySelectorAll(".call-popup__close"),openButtons:document.querySelectorAll("[data-popup-open='call']")}),donePopup=new Popups({popup:document.querySelector(".done-popup"),closeButtons:document.querySelectorAll(".done-popup__button"),openButtons:document.querySelectorAll("[data-popup-open='done']")}),application=document.forms.application,applicationFrom=new Form(application,{errorClass:"input__error",popupNext:donePopup}),designer=document.forms.designer,designerFrom=new Form(designer,{errorClass:"input__error",popupNext:donePopup}),calc=document.forms.calc,calcFrom=new Form(calc,{errorClass:"input__error",popupCurrent:calcPopup,popupNext:donePopup}),call=document.forms.call,callFrom=new Form(call,{errorClass:"input__error",popupCurrent:callPopup,popupNext:donePopup}),rotateBetweenWords=e=>{var t;let s=0;for(t of document.querySelectorAll(".circle-text__word"))t.style.transform=`rotate(${s}deg)`,s+=e},rotateBetweenLetters=e=>{var t;let s=0;for(t of document.querySelectorAll(".circle-text__letter"))t.style.transform=`rotate(${s}deg)`,s+=e},kitchenSmallSwiper=(rotateBetweenWords(0),rotateBetweenLetters(10.5),new Swiper(".kitchen-large__swiper",{loop:!0,observer:!0,observerParents:!0,slidesPerView:1,spaceBetween:32,speed:800,loopAdditionalSlides:5,preloadImages:!1,lazy:!0,navigation:{nextEl:".kitchen-large__controls_right",prevEl:".kitchen-large__controls_left"}})),kitchenLargeSwiper=new Swiper(".kitchen-small__swiper",{slidesPerView:1,spaceBetween:32,speed:800,loop:!0,preloadImages:!1,lazy:!0,navigation:{nextEl:".kitchen-small__controls_right",prevEl:".kitchen-small__controls_left"}}),kitchenFullSwiper=new Swiper(".kitchen-full__swiper",{loop:!0,slidesPerView:1,spaceBetween:32,speed:800,preloadImages:!1,lazy:!0,navigation:{nextEl:".kitchen-full__controls_right",prevEl:".kitchen-full__controls_left"}}),gallaryDetailSwiper=new Swiper(".detail-gallary__swiper",{loop:!0,slidesPerView:"auto",spaceBetween:20,freeMode:!0}),popularKitSwiper=new Swiper(".popular-kit__swiper",{slidesPerView:1,spaceBetween:10,breakpoints:{375:{slidesPerView:1.3,spaceBetween:10},650:{slidesPerView:2,spaceBetween:40},1280:{slidesPerView:3,spaceBetween:30}},navigation:{nextEl:".popular-kit__button_right",prevEl:".popular-kit__button_left"}}),rewievsCardSwiper=new Swiper(".reviews-card__swiper",{slidesPerView:1,spaceBetween:10,speed:800,loop:!0,lazy:!0,navigation:{nextEl:".reviews-card__swiper-controls_right",prevEl:".reviews-card__swiper-controls_left"}}),materialsSwiper=new Swiper(".materials__swiper",{slidesPerView:1,spaceBetween:-10,parallax:!0,enabled:!1,speed:800,navigation:{nextEl:".materials__control-button"},breakpoints:{770.5:{enabled:!0}}});if(document.querySelector(".reviews-list__body")){const ia=new Masonry(".reviews-list__body",{itemSelector:".masonry-element",columnWidth:".reviews-list__card",gutter:".reviews-list__column-gap",percentPosition:!0})}if(document.querySelector(".benefits__body")){const ja=new Accordion(".benefits__body",{openOnInit:[0],collapse:!0})}if(document.querySelector(".filter-selector")){const ka=new Accordion(".filter-selector",{})}if(document.querySelector(".stages__accordion")){const la=[...document.querySelectorAll(".stages__accordion")],ma=new Accordion(la,{})}function header(){const e=document.querySelector(".header"),t=document.querySelector(".header__menu-btn");let s=!1;t.addEventListener("click",function(){s=s?(e.classList.remove("open-menu"),!1):(e.classList.add("open-menu"),!0)})}document.addEventListener("DOMContentLoaded",()=>{header()});